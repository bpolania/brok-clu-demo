^D+ REPO_ROOT=/Users/bpolania/Documents/GitHub/brok-clu-demo
+ echo ========================================
========================================
+ echo 'SCENARIO 02 — Non-root invocation'
SCENARIO 02 — Non-root invocation
+ echo ========================================
========================================
+ echo ''

+ echo '--- Common Header ---'
--- Common Header ---
++ date -u +%Y-%m-%dT%H:%M:%SZ
+ echo 'UTC Time: 2026-01-07T17:41:28Z'
UTC Time: 2026-01-07T17:41:28Z
++ cd /Users/bpolania/Documents/GitHub/brok-clu-demo
++ git rev-parse --show-toplevel
+ echo 'Repo root (git rev-parse): /Users/bpolania/Documents/GitHub/brok-clu-demo'
Repo root (git rev-parse): /Users/bpolania/Documents/GitHub/brok-clu-demo
+ echo ''

+ echo '--- Vendored tarball SHA-256 ---'
--- Vendored tarball SHA-256 ---
+ shasum -a 256 /Users/bpolania/Documents/GitHub/brok-clu-demo/vendor/poc_v2/poc_v2.tar.gz
7aa008f23f5fed51cb40c28ac8ec84fe036c3500ff2b9c51da1bb954bb74ed9a  /Users/bpolania/Documents/GitHub/brok-clu-demo/vendor/poc_v2/poc_v2.tar.gz
+ echo ''

+ echo '--- Test 1: Invoke from HOME ---'
--- Test 1: Invoke from HOME ---
+ cd /Users/bpolania
++ pwd
+ echo 'PWD: /Users/bpolania'
PWD: /Users/bpolania
+ echo 'Input argument form: absolute path'
Input argument form: absolute path
+ echo 'Resolved input path: /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt'
Resolved input path: /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt
+ echo 'Command: /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/run_poc_v2.sh --input /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt'
Command: /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/run_poc_v2.sh --input /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt
+ /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/run_poc_v2.sh --input /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt
run_directory: /Users/bpolania/Documents/GitHub/brok-clu-demo/artifacts/run/run_20260107T174128Z
verification: invoking /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/verify_poc_v2.sh
verification: exit_code=0
execution: running bundle verify to set internal state
execution: run_entrypoint=scripts/run.sh
execution: invoking with input=/Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt
execution: exit_code=0
+ RUN_EXIT_1=0
+ echo 'Exit code: 0'
Exit code: 0
+ echo ''

+ echo '--- Test 2: Invoke from nested temp directory ---'
--- Test 2: Invoke from nested temp directory ---
+ NESTED_TEMP=/tmp/phase_v2_6_test/deeply/nested/directory
+ mkdir -p /tmp/phase_v2_6_test/deeply/nested/directory
+ cd /tmp/phase_v2_6_test/deeply/nested/directory
++ pwd
+ echo 'PWD: /tmp/phase_v2_6_test/deeply/nested/directory'
PWD: /tmp/phase_v2_6_test/deeply/nested/directory
+ echo 'Input argument form: absolute path'
Input argument form: absolute path
+ echo 'Resolved input path: /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt'
Resolved input path: /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt
+ echo 'Command: /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/run_poc_v2.sh --input /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt'
Command: /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/run_poc_v2.sh --input /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt
+ /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/run_poc_v2.sh --input /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt
run_directory: /Users/bpolania/Documents/GitHub/brok-clu-demo/artifacts/run/run_20260107T174130Z
verification: invoking /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/verify_poc_v2.sh
verification: exit_code=0
execution: running bundle verify to set internal state
execution: run_entrypoint=scripts/run.sh
execution: invoking with input=/Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt
execution: exit_code=0
+ RUN_EXIT_2=0
+ echo 'Exit code: 0'
Exit code: 0
+ echo ''

+ echo '--- Test 3: Determinism from non-root directory ---'
--- Test 3: Determinism from non-root directory ---
++ pwd
+ echo 'PWD: /tmp/phase_v2_6_test/deeply/nested/directory'
PWD: /tmp/phase_v2_6_test/deeply/nested/directory
+ echo 'Command: /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/determinism_test_v2.sh --input /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt --runs 3'
Command: /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/determinism_test_v2.sh --input /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt --runs 3
+ /Users/bpolania/Documents/GitHub/brok-clu-demo/scripts/determinism_test_v2.sh --input /Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt --runs 3
determinism_test: directory=/Users/bpolania/Documents/GitHub/brok-clu-demo/artifacts/determinism/test_20260107T174132Z
determinism_test: input=/Users/bpolania/Documents/GitHub/brok-clu-demo/examples/inputs/accept_restart_alpha_1.txt
determinism_test: runs=3

determinism_test: run 1 of 3
determinism_test: run 1 completed (exit_code=0)
determinism_test: baseline set from run 1

determinism_test: run 2 of 3
determinism_test: run 2 completed (exit_code=0)

determinism_test: run 3 of 3
determinism_test: run 3 completed (exit_code=0)

determinism_test: PASS (all 3 runs identical)
+ DET_EXIT=0
+ echo 'Exit code: 0'
Exit code: 0
+ echo ''

+ echo '--- Cleanup nested temp ---'
--- Cleanup nested temp ---
+ rm -rf /tmp/phase_v2_6_test
+ echo ''

+ echo '--- Repo artifacts (run) ---'
--- Repo artifacts (run) ---
+ ls -lt /Users/bpolania/Documents/GitHub/brok-clu-demo/artifacts/run
+ head -n 10
total 0
drwxr-xr-x@  9 bpolania  staff  288 Jan  7 11:41 run_20260107T174136Z
drwxr-xr-x@  9 bpolania  staff  288 Jan  7 11:41 run_20260107T174134Z
drwxr-xr-x@  9 bpolania  staff  288 Jan  7 11:41 run_20260107T174132Z
drwxr-xr-x@  9 bpolania  staff  288 Jan  7 11:41 run_20260107T174130Z
drwxr-xr-x@  9 bpolania  staff  288 Jan  7 11:41 run_20260107T174128Z
drwxr-xr-x@  9 bpolania  staff  288 Jan  7 11:41 run_20260107T174126Z
drwxr-xr-x@  9 bpolania  staff  288 Jan  7 11:41 run_20260107T174124Z
drwxr-xr-x@  9 bpolania  staff  288 Jan  7 11:41 run_20260107T174122Z
drwxr-xr-x@  9 bpolania  staff  288 Jan  7 11:41 run_20260107T174120Z
+ echo ''

+ echo '--- Repo artifacts (determinism) ---'
--- Repo artifacts (determinism) ---
+ ls -lt /Users/bpolania/Documents/GitHub/brok-clu-demo/artifacts/determinism
+ head -n 5
total 0
drwxr-xr-x@  8 bpolania  staff  256 Jan  7 11:41 test_20260107T174132Z
drwxr-xr-x@ 10 bpolania  staff  320 Jan  7 11:41 test_20260107T174118Z
drwxr-xr-x@  8 bpolania  staff  256 Jan  7 11:34 test_20260107T173449Z
drwxr-xr-x@ 10 bpolania  staff  320 Jan  7 11:34 test_20260107T173434Z
++ ls -t /Users/bpolania/Documents/GitHub/brok-clu-demo/artifacts/determinism
++ head -n 1
+ LATEST_DET=test_20260107T174132Z
+ echo ''

+ echo 'Latest determinism result:'
Latest determinism result:
+ cat /Users/bpolania/Documents/GitHub/brok-clu-demo/artifacts/determinism/test_20260107T174132Z/result.txt
PASS: All 3 runs produced identical stdout.raw.kv
+ echo ''

+ echo ========================================
========================================
+ echo 'SCENARIO 02 COMPLETE'
SCENARIO 02 COMPLETE
+ echo 'run_poc_v2.sh exit code (from HOME): 0'
run_poc_v2.sh exit code (from HOME): 0
+ echo 'run_poc_v2.sh exit code (from nested temp): 0'
run_poc_v2.sh exit code (from nested temp): 0
+ echo 'determinism_test_v2.sh exit code: 0'
determinism_test_v2.sh exit code: 0
+ echo ========================================
========================================
+ exit 0
